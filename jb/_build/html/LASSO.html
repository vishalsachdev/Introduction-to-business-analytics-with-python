
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>LASSO Regression &#8212; My Jupyter Book</title>
    
  <link href="_static/css/theme.css" rel="stylesheet" />
  <link href="_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/togglebutton.js"></script>
    <script src="_static/clipboard.min.js"></script>
    <script src="_static/copybutton.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="_static/sphinx-thebe.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="EDA + Data Visualization" href="EDA.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="index.html">
      
      
      <h1 class="site-logo" id="site-title">My Jupyter Book</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DM1.html">
   Data Mining Process Overview
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="DM2.html">
   Data Mining Process Overview (Cont.)
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Clustering.html">
   Similarity + Clustering
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="EDA.html">
   EDA + Data Visualization
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   LASSO Regression
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="_sources/LASSO.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/executablebooks/jupyter-book/master?urlpath=tree/LASSO.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#overview">
   Overview
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#toyota-corollas-data">
     Toyota Corollas Data
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#data-processing">
   Data Processing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-building">
   Model Building
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#plotting-values">
   Plotting ùúÜ  values
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="lasso-regression">
<h1>LASSO Regression<a class="headerlink" href="#lasso-regression" title="Permalink to this headline">¬∂</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>
<span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">Lasso</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="kn">from</span> <span class="nn">dmba</span> <span class="kn">import</span> <span class="n">regressionSummary</span>
<span class="o">%</span><span class="k">matplotlib</span> inline
</pre></div>
</div>
</div>
</div>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¬∂</a></h2>
<p>The Lasso is a shrinkage and selection method for linear regression. It minimizes the usual sum of squared errors, with a bound on the sum of the absolute values of the coefficients.</p>
<p>It includes a ‚Äúpenalty‚Äù that is based on aggregation of coefficient values. Standardizing the variable is important in this method, as this will prepare your data for wrangling and will allow you to draw clearer conclusions.</p>
<p>In this chapter we will provide an example of how to implement LASSO. This is a feature selection method that shrinks our coefficient estimates (<span class="math notranslate nohighlight">\(\hat{\beta}_i\)</span>s) towards zero, even setting some to be 0. This helps us create an easier-to-interpret model and reduces the risk of overfitting. (Recall, overfitting my model means I‚Äôve made a model that fits too closely to the training data but isn‚Äôt generalizable to other data - therefore, it won‚Äôt make good predictions.)</p>
<p>We‚Äôll implement LASSO using our beloved Toyota Corolla dataset. In the MLR notebook, we learned how to use MLR to make predictions about the price a used Toyota Corolla would sell for based on car features. In this notebook, we‚Äôll learn how to use LASSO to make those predictions.</p>
<div class="section" id="toyota-corollas-data">
<h3>Toyota Corollas Data<a class="headerlink" href="#toyota-corollas-data" title="Permalink to this headline">¬∂</a></h3>
<p>This data represents the sale of used Toyota Corollas in the Netherlands, and our mission is to <strong>predict the price of a car based on its options and features</strong>.</p>
<p>Below, we show descriptions of some of the variables in our dataset.</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Variable</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Price</p></td>
<td><p>Offer price in Euros</p></td>
</tr>
<tr class="row-odd"><td><p>Age</p></td>
<td><p>Age in months as of August 2004</p></td>
</tr>
<tr class="row-even"><td><p>Kilometers</p></td>
<td><p>Accumulated Kilometers on odometer</p></td>
</tr>
<tr class="row-odd"><td><p>Fuel type</p></td>
<td><p>Fuel type (Petrol, Diesel, CNG)</p></td>
</tr>
<tr class="row-even"><td><p>HP</p></td>
<td><p>Horsepower</p></td>
</tr>
<tr class="row-odd"><td><p>Metallic</p></td>
<td><p>Metallic color (Yes = 1, No= 0)</p></td>
</tr>
<tr class="row-even"><td><p>Automatic</p></td>
<td><p>Automatic (Yes = 1, No = 0)</p></td>
</tr>
<tr class="row-odd"><td><p>CC</p></td>
<td><p>Cylinder volume in cubic centimeters</p></td>
</tr>
<tr class="row-even"><td><p>Doors</p></td>
<td><p>Number of doors</p></td>
</tr>
<tr class="row-odd"><td><p>QuartTax</p></td>
<td><p>Quarterly road tax in Euros</p></td>
</tr>
<tr class="row-even"><td><p>Weight</p></td>
<td><p>Weight in Kilograms</p></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="section" id="data-processing">
<h2>Data Processing<a class="headerlink" href="#data-processing" title="Permalink to this headline">¬∂</a></h2>
<p>Read the data using the <code class="docutils literal notranslate"><span class="pre">read_csv</span></code> function from pandas package and save it as the dataframe <code class="docutils literal notranslate"><span class="pre">car_df</span></code>. The data is called <code class="docutils literal notranslate"><span class="pre">'ToyotaCorolla.csv'</span></code>. Use the <code class="docutils literal notranslate"><span class="pre">.head()</span></code> method to make sure the dataframe has been created correctly.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;../jb/data/ToyotaCorolla.csv&#39;</span><span class="p">)</span>
<span class="n">car_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Id</th>
      <th>Model</th>
      <th>Price</th>
      <th>Age_08_04</th>
      <th>Mfg_Month</th>
      <th>Mfg_Year</th>
      <th>KM</th>
      <th>Fuel_Type</th>
      <th>HP</th>
      <th>Met_Color</th>
      <th>...</th>
      <th>Powered_Windows</th>
      <th>Power_Steering</th>
      <th>Radio</th>
      <th>Mistlamps</th>
      <th>Sport_Model</th>
      <th>Backseat_Divider</th>
      <th>Metallic_Rim</th>
      <th>Radio_cassette</th>
      <th>Parking_Assistant</th>
      <th>Tow_Bar</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors</td>
      <td>13500</td>
      <td>23</td>
      <td>10</td>
      <td>2002</td>
      <td>46986</td>
      <td>Diesel</td>
      <td>90</td>
      <td>1</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors</td>
      <td>13750</td>
      <td>23</td>
      <td>10</td>
      <td>2002</td>
      <td>72937</td>
      <td>Diesel</td>
      <td>90</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors</td>
      <td>13950</td>
      <td>24</td>
      <td>9</td>
      <td>2002</td>
      <td>41711</td>
      <td>Diesel</td>
      <td>90</td>
      <td>1</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>TOYOTA Corolla 2.0 D4D HATCHB TERRA 2/3-Doors</td>
      <td>14950</td>
      <td>26</td>
      <td>7</td>
      <td>2002</td>
      <td>48000</td>
      <td>Diesel</td>
      <td>90</td>
      <td>0</td>
      <td>...</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>TOYOTA Corolla 2.0 D4D HATCHB SOL 2/3-Doors</td>
      <td>13750</td>
      <td>30</td>
      <td>3</td>
      <td>2002</td>
      <td>38500</td>
      <td>Diesel</td>
      <td>90</td>
      <td>0</td>
      <td>...</td>
      <td>1</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
<p>5 rows √ó 39 columns</p>
</div></div></div>
</div>
<p>We use the map function to iterate through a list of values (in this case, the column names, and apply a function to each item in the list. In this case, we want make each item lowercase.)</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_df</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">,</span> <span class="n">car_df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
<span class="n">car_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;id&#39;, &#39;model&#39;, &#39;price&#39;, &#39;age_08_04&#39;, &#39;mfg_month&#39;, &#39;mfg_year&#39;, &#39;km&#39;,
       &#39;fuel_type&#39;, &#39;hp&#39;, &#39;met_color&#39;, &#39;color&#39;, &#39;automatic&#39;, &#39;cc&#39;, &#39;doors&#39;,
       &#39;cylinders&#39;, &#39;gears&#39;, &#39;quarterly_tax&#39;, &#39;weight&#39;, &#39;mfr_guarantee&#39;,
       &#39;bovag_guarantee&#39;, &#39;guarantee_period&#39;, &#39;abs&#39;, &#39;airbag_1&#39;, &#39;airbag_2&#39;,
       &#39;airco&#39;, &#39;automatic_airco&#39;, &#39;boardcomputer&#39;, &#39;cd_player&#39;,
       &#39;central_lock&#39;, &#39;powered_windows&#39;, &#39;power_steering&#39;, &#39;radio&#39;,
       &#39;mistlamps&#39;, &#39;sport_model&#39;, &#39;backseat_divider&#39;, &#39;metallic_rim&#39;,
       &#39;radio_cassette&#39;, &#39;parking_assistant&#39;, &#39;tow_bar&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>We can see that <code class="docutils literal notranslate"><span class="pre">id</span></code> and <code class="docutils literal notranslate"><span class="pre">model</span></code> aren‚Äôt useful to include, as <code class="docutils literal notranslate"><span class="pre">id</span></code> provides a unique but meaningless number for each row, and model is not important, as these are all Toyota Corollas. Let‚Äôs drop those.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_df</span><span class="o">=</span><span class="n">car_df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span> <span class="o">=</span><span class="p">[</span><span class="s1">&#39;model&#39;</span><span class="p">,</span><span class="s1">&#39;id&#39;</span><span class="p">])</span> 
<span class="n">car_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;price&#39;, &#39;age_08_04&#39;, &#39;mfg_month&#39;, &#39;mfg_year&#39;, &#39;km&#39;, &#39;fuel_type&#39;, &#39;hp&#39;,
       &#39;met_color&#39;, &#39;color&#39;, &#39;automatic&#39;, &#39;cc&#39;, &#39;doors&#39;, &#39;cylinders&#39;, &#39;gears&#39;,
       &#39;quarterly_tax&#39;, &#39;weight&#39;, &#39;mfr_guarantee&#39;, &#39;bovag_guarantee&#39;,
       &#39;guarantee_period&#39;, &#39;abs&#39;, &#39;airbag_1&#39;, &#39;airbag_2&#39;, &#39;airco&#39;,
       &#39;automatic_airco&#39;, &#39;boardcomputer&#39;, &#39;cd_player&#39;, &#39;central_lock&#39;,
       &#39;powered_windows&#39;, &#39;power_steering&#39;, &#39;radio&#39;, &#39;mistlamps&#39;,
       &#39;sport_model&#39;, &#39;backseat_divider&#39;, &#39;metallic_rim&#39;, &#39;radio_cassette&#39;,
       &#39;parking_assistant&#39;, &#39;tow_bar&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Recall that we have to convert categorical variables to numbers. We only have nominal (unordered) categorical variables, so they should be converted to a set of dummy variables.</p>
<p>We‚Äôve already dropped <code class="docutils literal notranslate"><span class="pre">model</span></code>, so our two remaining categorical variables are <code class="docutils literal notranslate"><span class="pre">color</span></code> and <code class="docutils literal notranslate"><span class="pre">fuel_type</span></code>.</p>
<p>We use <code class="docutils literal notranslate"><span class="pre">pd.get_dummies</span></code>  to dummy-code all the variables. Each categorical variable will generate two or more dummy variables. Dropping the first dummy variable  (using the argument <code class="docutils literal notranslate"><span class="pre">drop_first</span></code>) ensures we won‚Äôt have problems with perfect multicollinearity.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">get_dummies</span><span class="p">(</span><span class="n">car_df</span><span class="p">,</span> <span class="n">drop_first</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">car_df</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Index([&#39;price&#39;, &#39;age_08_04&#39;, &#39;mfg_month&#39;, &#39;mfg_year&#39;, &#39;km&#39;, &#39;hp&#39;, &#39;met_color&#39;,
       &#39;automatic&#39;, &#39;cc&#39;, &#39;doors&#39;, &#39;cylinders&#39;, &#39;gears&#39;, &#39;quarterly_tax&#39;,
       &#39;weight&#39;, &#39;mfr_guarantee&#39;, &#39;bovag_guarantee&#39;, &#39;guarantee_period&#39;, &#39;abs&#39;,
       &#39;airbag_1&#39;, &#39;airbag_2&#39;, &#39;airco&#39;, &#39;automatic_airco&#39;, &#39;boardcomputer&#39;,
       &#39;cd_player&#39;, &#39;central_lock&#39;, &#39;powered_windows&#39;, &#39;power_steering&#39;,
       &#39;radio&#39;, &#39;mistlamps&#39;, &#39;sport_model&#39;, &#39;backseat_divider&#39;, &#39;metallic_rim&#39;,
       &#39;radio_cassette&#39;, &#39;parking_assistant&#39;, &#39;tow_bar&#39;, &#39;fuel_type_Diesel&#39;,
       &#39;fuel_type_Petrol&#39;, &#39;color_Black&#39;, &#39;color_Blue&#39;, &#39;color_Green&#39;,
       &#39;color_Grey&#39;, &#39;color_Red&#39;, &#39;color_Silver&#39;, &#39;color_Violet&#39;,
       &#39;color_White&#39;, &#39;color_Yellow&#39;],
      dtype=&#39;object&#39;)
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs use bracket notation with the new column names to again select the first three rows. What do we see? The first car (row index equal to 0) had a blue car that used diesel. We see below that fuel_type_Diesel = 1, color_Blue = 1, and all the other dummy variables are equal to 0.</p>
<p>For a car with fuel type CNG, what would fuel_type_Diesel and fuel_type_Petrol equal?</p>
<p>How would I know from these new dummy variables that a car is Beige?</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_df</span><span class="p">[[</span><span class="s1">&#39;fuel_type_Diesel&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_type_Petrol&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Black&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Blue&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Green&#39;</span><span class="p">,</span>
       <span class="s1">&#39;color_Grey&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Red&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Silver&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Violet&#39;</span><span class="p">,</span>
       <span class="s1">&#39;color_White&#39;</span><span class="p">,</span> <span class="s1">&#39;color_Yellow&#39;</span><span class="p">]]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fuel_type_Diesel</th>
      <th>fuel_type_Petrol</th>
      <th>color_Black</th>
      <th>color_Blue</th>
      <th>color_Green</th>
      <th>color_Grey</th>
      <th>color_Red</th>
      <th>color_Silver</th>
      <th>color_Violet</th>
      <th>color_White</th>
      <th>color_Yellow</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</div>
<hr class="docutils" />
<div class="section" id="model-building">
<h2>Model Building<a class="headerlink" href="#model-building" title="Permalink to this headline">¬∂</a></h2>
<p>Now, we can finally move on to what we‚Äôre really interested in - using a regularization technique called LASSO to help us decide which predictors we should include in our model.</p>
<p>Let‚Äôs define our predictors and outcome variable. <strong>Lasso will help me determine which, if any, predictor variables I should drop.</strong></p>
<p>We‚Äôll then create the training and test sets, using our <code class="docutils literal notranslate"><span class="pre">X</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code> objects.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">outcome</span> <span class="o">=</span> <span class="s1">&#39;price&#39;</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;age_08_04&#39;</span><span class="p">,</span> <span class="s1">&#39;km&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_type_Petrol&#39;</span><span class="p">,</span> <span class="s1">&#39;fuel_type_Diesel&#39;</span><span class="p">,</span> <span class="s1">&#39;hp&#39;</span><span class="p">,</span> <span class="s1">&#39;met_color&#39;</span><span class="p">,</span> <span class="s1">&#39;automatic&#39;</span><span class="p">,</span> <span class="s1">&#39;cc&#39;</span><span class="p">,</span> <span class="s1">&#39;doors&#39;</span><span class="p">,</span> <span class="s1">&#39;quarterly_tax&#39;</span><span class="p">,</span> <span class="s1">&#39;weight&#39;</span><span class="p">]</span>

<span class="n">X</span> <span class="o">=</span> <span class="n">car_df</span><span class="p">[</span><span class="n">predictors</span><span class="p">]</span> 
<span class="n">y</span> <span class="o">=</span> <span class="n">car_df</span><span class="p">[</span><span class="n">outcome</span><span class="p">]</span> 

<span class="n">train_X</span><span class="p">,</span> <span class="n">valid_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">,</span> <span class="n">valid_y</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">test_size</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span> <span class="n">random_state</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span> 
<span class="n">train_X</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>age_08_04</th>
      <th>km</th>
      <th>fuel_type_Petrol</th>
      <th>fuel_type_Diesel</th>
      <th>hp</th>
      <th>met_color</th>
      <th>automatic</th>
      <th>cc</th>
      <th>doors</th>
      <th>quarterly_tax</th>
      <th>weight</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1238</th>
      <td>75</td>
      <td>82256</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>1</td>
      <td>0</td>
      <td>1600</td>
      <td>3</td>
      <td>69</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>1085</th>
      <td>79</td>
      <td>131500</td>
      <td>0</td>
      <td>1</td>
      <td>72</td>
      <td>0</td>
      <td>0</td>
      <td>2000</td>
      <td>5</td>
      <td>185</td>
      <td>1140</td>
    </tr>
    <tr>
      <th>680</th>
      <td>61</td>
      <td>102106</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>0</td>
      <td>0</td>
      <td>1600</td>
      <td>3</td>
      <td>69</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>593</th>
      <td>50</td>
      <td>22648</td>
      <td>1</td>
      <td>0</td>
      <td>97</td>
      <td>1</td>
      <td>0</td>
      <td>1400</td>
      <td>5</td>
      <td>85</td>
      <td>1060</td>
    </tr>
    <tr>
      <th>647</th>
      <td>68</td>
      <td>117000</td>
      <td>0</td>
      <td>1</td>
      <td>72</td>
      <td>0</td>
      <td>0</td>
      <td>2000</td>
      <td>3</td>
      <td>185</td>
      <td>1115</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>715</th>
      <td>62</td>
      <td>90000</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>0</td>
      <td>0</td>
      <td>1600</td>
      <td>3</td>
      <td>69</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>905</th>
      <td>65</td>
      <td>59000</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>0</td>
      <td>0</td>
      <td>1600</td>
      <td>3</td>
      <td>69</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>1096</th>
      <td>75</td>
      <td>125400</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>0</td>
      <td>0</td>
      <td>1600</td>
      <td>3</td>
      <td>69</td>
      <td>1050</td>
    </tr>
    <tr>
      <th>235</th>
      <td>38</td>
      <td>60829</td>
      <td>1</td>
      <td>0</td>
      <td>110</td>
      <td>1</td>
      <td>0</td>
      <td>1600</td>
      <td>5</td>
      <td>85</td>
      <td>1075</td>
    </tr>
    <tr>
      <th>1061</th>
      <td>78</td>
      <td>161775</td>
      <td>1</td>
      <td>0</td>
      <td>86</td>
      <td>1</td>
      <td>0</td>
      <td>1300</td>
      <td>3</td>
      <td>69</td>
      <td>1015</td>
    </tr>
  </tbody>
</table>
<p>861 rows √ó 11 columns</p>
</div></div></div>
</div>
<p>Remember that in a LASSO model, we penalize large coefficient estimates. The magnitude of a coefficient estimate can vary depending on the units of the variable. We address this by standardizing our data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1">#Standardization</span>

<span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>

<span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="n">train_X</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit_transform</span><span class="p">(</span><span class="n">train_X</span><span class="p">)</span>
<span class="n">valid_X</span><span class="o">=</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">valid_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Fitting a LASSO model is very similar to fitting an MLR model, except we‚Äôll need to specify the penalty parameter, <span class="math notranslate nohighlight">\(\lambda\)</span>. Somewhat confusingly, we specify <span class="math notranslate nohighlight">\(\lambda\)</span> in the <code class="docutils literal notranslate"><span class="pre">alpha</span></code> argument in the LASSO function. (LASSO is an algorithm in the scikit learn package.)</p>
<p>We need to take the following steps.</p>
<ol class="simple">
<li><p>Choose a value for <span class="math notranslate nohighlight">\(\lambda\)</span> (the penalty parameter). Below, we set it to equal 1.</p></li>
<li><p>Initialize the LASSO algorithm, setting the <span class="math notranslate nohighlight">\(\lambda\)</span> value (alpha argument)</p></li>
<li><p>Fit the model using the training data (this finds the best coefficients AKA the <span class="math notranslate nohighlight">\(\hat{\beta}_i\)</span>s)</p></li>
<li><p>Use the results (that is, use the coefficient estimates) from the fitted model to predict the outcome (price) for the validation data</p></li>
</ol>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Step 1: Set lambda</span>
<span class="n">lambda_val</span> <span class="o">=</span> <span class="mi">1</span>

<span class="c1"># Step 2: load the lasso regression algorithm into an object called &quot;car_lasso&quot;</span>
<span class="n">car_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">lambda_val</span><span class="p">)</span>

<span class="c1"># Step 3: fit the lasso model using the training data</span>
<span class="n">car_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>

<span class="c1"># Step 4 use the fitted model to predict the outcome for the validation data</span>
<span class="n">car_lasso_predict</span> <span class="o">=</span> <span class="n">car_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">regressionSummary</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span> <span class="n">car_lasso_predict</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Regression statistics

                      Mean Error (ME) : 187.2769
       Root Mean Squared Error (RMSE) : 3244.3391
            Mean Absolute Error (MAE) : 1090.5446
          Mean Percentage Error (MPE) : 0.2298
Mean Absolute Percentage Error (MAPE) : 10.3188
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Estimated coefficients</span>
<span class="n">car_lasso</span><span class="o">.</span><span class="n">coef_</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-2351.6150999 ,  -604.89497276,   752.46914729,  1336.31090827,
        1088.08162747,    21.35621241,   110.22159955,  -919.41872088,
          52.85072699,   539.28619666,   799.29743289])
</pre></div>
</div>
</div>
</div>
<p>In the previous step, we used a <span class="math notranslate nohighlight">\(\lambda\)</span> value of 1 when fitting the LASSO regression model. However, how do we know whether 1 is a good choice for <span class="math notranslate nohighlight">\(\lambda\)</span>? We don‚Äôt!</p>
<p>The beauty of Python is that we can quickly try lots of different <span class="math notranslate nohighlight">\(\lambda\)</span> values and find the one that does best, where doing best means minimizing the error. To do this, we‚Äôll put the above steps into a for loop, where we fit a LASSO regression model for many different values of <span class="math notranslate nohighlight">\(\lambda\)</span>. We can then choose the <span class="math notranslate nohighlight">\(\lambda\)</span> value that results in the best prediction (lowest error).</p>
</div>
<hr class="docutils" />
<div class="section" id="plotting-values">
<h2>Plotting ùúÜ  values<a class="headerlink" href="#plotting-values" title="Permalink to this headline">¬∂</a></h2>
<p>Now, let‚Äôs use the create a for loop to fit the LASSO regression model for many different <span class="math notranslate nohighlight">\(\lambda\)</span> values. Let‚Äôs break this down into several steps.</p>
<p>First, decide what you want to use as your <span class="math notranslate nohighlight">\(\lambda\)</span> values. We put this <span class="math notranslate nohighlight">\(\lambda\)</span> values into a list. I‚Äôve created a few lists of <span class="math notranslate nohighlight">\(\lambda\)</span> values below. I‚Äôve commented out all but one - you can uncomment to try to different lists or even make your own.</p>
<p>For whatever list I create, I save the length of the list (that is, the number of <span class="math notranslate nohighlight">\(\lambda\)</span> in my list) as <code class="docutils literal notranslate"><span class="pre">l_num</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Define lambda to be used in LASS0 </span>
<span class="c1"># lambdas = [0.1,1,5,10]</span>
<span class="c1"># lambdas = (0.1,1,5,10,100,500,1000)</span>
<span class="n">lambdas</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="c1"># Length of lambda</span>
<span class="n">l_num</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">lambdas</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Next, create an empty array (sort of a fancy list) to hold the hold the prediction accuracy measure for each fitted model. Remember, we‚Äôll have the same number of models as we have <span class="math notranslate nohighlight">\(\lambda\)</span>s in our list above, so we create an array that is the same length. We put in zeros as placeholders.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># initilize a vector to hold values of RMSE</span>
<span class="n">valid_RMSE</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">l_num</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we're ready for our for loop! For every single $\lambda$ in our list above, we want to fit a LASSO regression model, using that $\lambda$ value. So, we need to iterate through our list of $\lambda$s. As I iterate through the list, I get two pieces of information about the $\lambda$: the index (it's order in the list) and the actual $\lambda$ value.</p><p>Okay, finally ready to put the for loop code together with the LASSO code! Let‚Äôs do it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># enumerate through lambdas with index and val</span>
<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">lambdas</span><span class="p">):</span>  
    <span class="c1"># Initialize the lasso regression by setting the penalty parameter equal to lambda[ind]</span>
    <span class="n">car_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">val</span><span class="p">)</span>
    <span class="c1"># Fit the lasso model using training data</span>
    <span class="n">car_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>
    <span class="c1"># Calculate the error using the RMSE function and using the validation set data</span>
    <span class="c1"># Save this RMSE into the appropriate position in the RMSE array    </span>
    <span class="n">valid_RMSE</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">car_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_X</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output traceback highlight-ipythontb notranslate"><div class="highlight"><pre><span></span><span class="gt">---------------------------------------------------------------------------</span>
<span class="ne">NameError</span><span class="g g-Whitespace">                                 </span>Traceback (most recent call last)
<span class="o">&lt;</span><span class="n">ipython</span><span class="o">-</span><span class="nb">input</span><span class="o">-</span><span class="mi">14</span><span class="o">-</span><span class="mi">2</span><span class="n">fe1df20e0b9</span><span class="o">&gt;</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="g g-Whitespace">      </span><span class="mi">7</span>     <span class="c1"># Calculate the error using the RMSE function and using the validation set data</span>
<span class="g g-Whitespace">      </span><span class="mi">8</span>     <span class="c1"># Save this RMSE into the appropriate position in the RMSE array</span>
<span class="ne">----&gt; </span><span class="mi">9</span>     <span class="n">valid_RMSE</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">valid_y</span><span class="p">,</span><span class="n">car_lasso</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">valid_X</span><span class="p">))</span>

<span class="ne">NameError</span>: name &#39;rmse&#39; is not defined
</pre></div>
</div>
</div>
</div>
<p>We‚Äôve now fit {l_num} models and for each one we‚Äôve saved the RMSE. Let‚Äôs look at how they do using a plot!</p>
<p>When you run the code, you‚Äôll see that for a smaller lambda value, the RMSE is higher (overfitting). As lambda increases, my RMSE starts to drop; the sweet spot is at around lambda = 5. As my <span class="math notranslate nohighlight">\(\lambda\)</span> continutes to increase, my RMSE shoots up, my lambda starts to increase again. For these larger lambdas, I‚Äôm penalizing the magnitude of the coefficients to the point where I‚Äôm shrinking lots of the coefficients to zero, which means I‚Äôm (implicitly) dropping a lot of predictors out of my model. In this case, I‚Äôm underfitting.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambdas</span><span class="p">,</span><span class="n">valid_RMSE</span><span class="p">,</span> <span class="s1">&#39;bo-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="sa">r</span><span class="s1">&#39;$RMSE$ Test set&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkred&quot;</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.6</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Lambda value&#39;</span><span class="p">);</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;$RMSE$&#39;</span><span class="p">)</span>
<span class="c1">#plt.xlim(0, 6)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;Evaluate lasso regression with different lambdas&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">car_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="mi">13</span><span class="p">)</span>
<span class="n">car_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>
<span class="n">car_lasso</span><span class="o">.</span><span class="n">coef_</span>

<span class="k">for</span> <span class="n">ind</span><span class="p">,</span> <span class="n">val</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">car_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">):</span>  
    <span class="n">predvar</span> <span class="o">=</span> <span class="n">predictors</span><span class="p">[</span><span class="n">ind</span><span class="p">]</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The estimated coefficient for&quot;</span><span class="p">,</span><span class="n">predvar</span><span class="p">,</span><span class="s2">&quot;is&quot;</span><span class="p">,</span><span class="nb">round</span><span class="p">(</span><span class="n">val</span><span class="p">,</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Let‚Äôs look at the ‚Äúpaths‚Äù of the coefficients as <span class="math notranslate nohighlight">\(\lambda\)</span> increases. To do this, we take the following steps.</p>
<ol class="simple">
<li><p>Set the list of <span class="math notranslate nohighlight">\(\lambda\)</span>s. Use a wider range to see when the coefficients are pushed down to zero.</p></li>
<li><p>Run the LASSO model for each of the <span class="math notranslate nohighlight">\(\lambda\)</span> in the list. Save the coefficients generated from each fitted model</p></li>
<li><p>Create a plot of each of the coefficient estimates as a function of <span class="math notranslate nohighlight">\(\lambda\)</span>.</p></li>
</ol>
<p>Notice how as <span class="math notranslate nohighlight">\(\lambda\)</span> increases, the magnitude of more and more of the coefficients are pushed towards zero? By the time <span class="math notranslate nohighlight">\(\lambda\)</span> is 100, only <code class="docutils literal notranslate"><span class="pre">age_08_04</span></code>, <code class="docutils literal notranslate"><span class="pre">hp</span></code>, <code class="docutils literal notranslate"><span class="pre">quarterly_tax</span></code>, <code class="docutils literal notranslate"><span class="pre">weight</span></code>, and <code class="docutils literal notranslate"><span class="pre">km</span></code> have non-zero coefficients.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Set lambdas</span>
<span class="n">lambdas</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">15</span><span class="p">,</span><span class="mi">50</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="mi">500</span><span class="p">,</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">3000</span><span class="p">]</span>

<span class="c1"># Fit lasso regression for each lambda, save coefficients</span>
<span class="n">coefs</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">val</span> <span class="ow">in</span> <span class="n">lambdas</span><span class="p">:</span>
    <span class="n">car_lasso</span> <span class="o">=</span> <span class="n">Lasso</span><span class="p">(</span><span class="n">alpha</span> <span class="o">=</span> <span class="n">val</span><span class="p">)</span>
    <span class="n">car_lasso</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train_X</span><span class="p">,</span> <span class="n">train_y</span><span class="p">)</span>
    <span class="n">coefs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">car_lasso</span><span class="o">.</span><span class="n">coef_</span><span class="p">)</span>
    
    
<span class="c1"># Generate a plot</span>
<span class="c1"># Use log scale so that we can see it a little more easily</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">lambdas</span><span class="p">,</span> <span class="n">coefs</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s2">&quot;o&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;lambda&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Coefficients (beta hats)&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Lasso coefficients as a function of choice of lambda&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span><span class="n">prop</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;size&#39;</span><span class="p">:</span> <span class="mi">15</span><span class="p">})</span>

<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="EDA.html" title="previous page">EDA + Data Visualization</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By The Jupyter Book community<br/>
        
            &copy; Copyright 2020.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>